lb-db:
  image: 'tutum/haproxy:0.1'
  environment:
    - BACKEND_PORTS=28015
    - MODE=tcp
  links:
    - rethinkdb
  ports:
    - '8082:1936'
    - '28015:80'
  roles:
    - global
lb-ui:
  image: 'tutum/haproxy:0.1'
  environment:
    - BACKEND_PORTS=8080
    - MODE=http
  links:
    - rethinkdb
  ports:
    - '8080:80'
    - '8081:1936'
  roles:
    - global
rethinkdb:
  image: 'anapsix/rethinkdb:latest'
  deployment_strategy: high_availability
  restart: on-failure
  target_num_containers: 2

